<div class="page">
  <div class="top">
    <div class="header-row">
      <div>
        <div class="title">Users</div>
        <div class="subtitle">{{ total() }} customers</div>
      </div>
      <div class="search-box">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
        <input 
          type="text" 
          placeholder="Search users..." 
          [ngModel]="searchQuery()" 
          (ngModelChange)="onSearch($event)"
        >
      </div>
    </div>
  </div>

  <div class="actions-bar" *ngIf="hasSelection()">
    <div class="selection-count">{{ selectedUsers().size }} selected</div>
    <div class="actions">
      <button class="action-btn delete" (click)="deleteSelected()">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        </svg>
        Delete Selected
      </button>
    </div>
  </div>

  <div class="card empty-state" *ngIf="total() === 0 && !loading()">
    <div class="empty-icon">
      <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
      </svg>
    </div>
    <div class="empty-text">No users found</div>
    <div class="empty-sub" *ngIf="searchQuery()">Try adjusting your search query</div>
  </div>

  <div class="list" *ngIf="total() > 0">
    <div class="list-header">
      <div class="checkbox-col">
        <input type="checkbox" [checked]="isAllSelected()" (change)="toggleAll()">
      </div>
      <div class="info-col">User Info</div>
      <div class="actions-col">Actions</div>
    </div>
    <div class="user" *ngFor="let u of users()">
      <div class="checkbox-col">
        <input type="checkbox" [checked]="selectedUsers().has(u.id)" (change)="toggleSelection(u.id)">
      </div>
      <div class="avatar">
        {{ u.fullName.charAt(0).toUpperCase() }}
      </div>
      <div class="info">
        <div class="name">{{ u.fullName || 'Customer' }}</div>
        <div class="meta">{{ u.phone }} â€¢ {{ u.email || '-' }}</div>
        <div class="addr">{{ u.address || u.location || '-' }}</div>
      </div>
      <div class="actions">
        <button class="icon-btn delete" (click)="deleteUser(u.id)" title="Delete User">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <div class="pagination" *ngIf="totalPages() > 1">
    <button class="page-btn nav" [disabled]="currentPage() === 1" (click)="setPage(currentPage() - 1)">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M15 18l-6-6 6-6" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
    
    <button 
      class="page-btn number" 
      *ngFor="let p of pages()" 
      [class.active]="p === currentPage()"
      (click)="setPage(p)">
      {{ p }}
    </button>

    <button class="page-btn nav" [disabled]="currentPage() === totalPages()" (click)="setPage(currentPage() + 1)">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 18l6-6-6-6" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </div>
</div>
